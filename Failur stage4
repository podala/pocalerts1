Very good question.

No â€” the previous Stage 4 description did NOT fully design **â€œNot Found / Insufficient Context / Zero-Result / Low-Confidenceâ€ handling** at enterprise depth.

That is critical in underwriting RAG.

Letâ€™s fix it properly.

---

# ğŸŸ¦ STAGE 4B â€” NOT FOUND / LOW CONFIDENCE HANDLING

This is part of Retrieval Engine, but it must be explicitly designed.

We handle **5 failure categories**, not just â€œno resultsâ€.

---

# ğŸ”· 1ï¸âƒ£ TYPE 1 â€” HARD ZERO RESULT

### Scenario

Vector search returns zero matches.

### Detection

```json
{
  "retrievedCount": 0
}
```

### Action

Return structured â€œNOT_FOUNDâ€.

### Response Payload

```json
{
  "queryId": "Q_20260222_0002",
  "status": "NOT_FOUND",
  "reason": "NO_VECTOR_MATCH",
  "recommendedActions": [
    "Broaden source filter",
    "Remove opportunity restriction",
    "Search across all client versions"
  ]
}
```

UI Should Show:

* â€œNo relevant documents foundâ€
* Suggested filter relaxation
* Expand scope toggle

---

# ğŸ”· 2ï¸âƒ£ TYPE 2 â€” BELOW SIMILARITY THRESHOLD

Matches found, but all below threshold (e.g. 0.75).

### Detection

```json
{
  "highestSimilarity": 0.61,
  "threshold": 0.75
}
```

### Action

Flag LOW_CONFIDENCE_RETRIEVAL.

### Response

```json
{
  "status": "LOW_CONFIDENCE",
  "confidenceScore": 0.42,
  "fallbackTriggered": true,
  "fallbackStrategy": "EXPAND_TO_ALL_REGULATIONS"
}
```

Fallback options:

* Increase numCandidates
* Broaden source types
* Expand to previous versions
* Lower threshold (if allowed)

---

# ğŸ”· 3ï¸âƒ£ TYPE 3 â€” POLICY BLOCKED

Chunks exist but user has no access.

### Detection

Vector count > 0
After policy filter â†’ 0

### Payload

```json
{
  "status": "ACCESS_RESTRICTED",
  "reason": "POLICY_BLOCK",
  "deniedChunkCount": 8,
  "visibleChunkCount": 0
}
```

UI should show:

> â€œRelevant content exists but you do not have access.â€

And optionally:

* Request access button
* Escalation workflow

---

# ğŸ”· 4ï¸âƒ£ TYPE 4 â€” SOURCE IMBALANCE (Critical for Your Use Case)

For underwriting:

If query requires:

* RFP + Regulation
* Or Pricing + Consultant

But retrieval only returns RFP

This is dangerous.

### Detection

```json
{
  "requiredSources": ["RFP", "Regulation"],
  "retrievedSources": ["RFP"]
}
```

### Action

Trigger targeted secondary retrieval for missing source.

If still not found:

```json
{
  "status": "PARTIAL_CONTEXT",
  "missingSources": ["Regulation"],
  "confidenceScore": 0.63
}
```

LLM must not answer regulatory compliance without regulation chunk.

---

# ğŸ”· 5ï¸âƒ£ TYPE 5 â€” CONTEXT TOO WEAK FOR ANSWER

Even if matches exist, CRAG evaluator may say:

* Coverage incomplete
* Conflict detected
* Low semantic density

### CRAG Evaluation Payload

```json
{
  "retrievalQualityScore": 0.48,
  "semanticCoverage": 0.51,
  "sourceDiversityScore": 0.33,
  "decision": "INSUFFICIENT_CONTEXT"
}
```

### Final Output

```json
{
  "status": "INSUFFICIENT_CONTEXT",
  "explanation": "Relevant regulation content not found to validate RFP rebate cap."
}
```

LLM must not hallucinate.

---

# ğŸŸ¦ ENTERPRISE NOT FOUND DECISION TREE

```
1. Vector search â†’ 0 results?
   â†’ HARD NOT_FOUND

2. Results exist â†’ below similarity threshold?
   â†’ LOW_CONFIDENCE

3. Results exist â†’ filtered by policy?
   â†’ ACCESS_RESTRICTED

4. Results exist â†’ missing required source types?
   â†’ PARTIAL_CONTEXT

5. Results exist â†’ CRAG low score?
   â†’ INSUFFICIENT_CONTEXT
```

---

# ğŸ”· UI DESIGN FOR NOT FOUND CASES

You should show:

| Case           | UI Message                     | Action                    |
| -------------- | ------------------------------ | ------------------------- |
| No match       | â€œNo relevant documents found.â€ | Expand filters            |
| Low confidence | â€œLow confidence result.â€       | Retry with broader search |
| Policy blocked | â€œAccess restricted.â€           | Request access            |
| Missing source | â€œRegulation not found.â€        | Expand regulation scope   |
| Weak context   | â€œInsufficient evidence.â€       | Manual review             |

---

# ğŸ”· RETRIEVAL LOGGING FOR FAILURE

```json
{
  "queryId": "Q_20260222_0002",
  "retrievalStatus": "LOW_CONFIDENCE",
  "retrievedCount": 3,
  "highestSimilarity": 0.61,
  "fallbackTriggered": true,
  "fallbackType": "EXPAND_SCOPE",
  "timestamp": "2026-02-22T14:10:00Z"
}
```

Metrics to Track:

* NotFoundRate
* LowConfidenceRate
* AccessRestrictedRate
* PartialContextRate
* CRAGRejectionRate
* HallucinationPreventionCount

---

# ğŸŸ¦ CRITICAL FOR YOUR DOMAIN

For underwriting RAG:

LLM must NEVER:

* Assume regulation exists
* Assume compliance
* Assume rebate cap
* Fabricate clause

If retrieval status != SUCCESS_WITH_CONFIDENCE
LLM must answer:

> â€œInsufficient regulatory context found to validate compliance.â€

This is enterprise-grade trustworthy RAG.

---

# ğŸ”· SUMMARY

Yes â€” now Not Found is fully handled.

We designed:

* 5 failure categories
* Payload structure
* Fallback strategies
* UI messaging
* Metrics
* LLM guardrails

---

If this is approved,
we move to:

ğŸŸ¦ Stage 5 â€” LLM Reasoning Layer
(Citation Enforcement + Conflict Resolution + Self-Check + Structured Answer + Feedback Capture)

Let me know.
