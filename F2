**Enterprise AI Underwriting: End-to-End Logical Flow â€“ SSD to RRF**

```text
ğŸ‘¤ Underwriter (User Identity)
â”‚
â”‚  "Can you review the SSD document for client XYZ?"
â–¼
ğŸ§­ Assistant Layer (Planner / Intent Router)
â”‚  - Detects intent: "Document Review"
â”‚  - Extracts: doc_type = SSD, client = XYZ
â”‚  - Loads session memory from Redis/LangGraph
â”‚  - Flags context: doc_scope = ["SSD"]
â”‚  - Routes task â†’ Document Assistance
â–¼
ğŸ“„ Document Assistance (Planner)
â”‚  - Filters request to SSD only
â”‚  - Annotates memory with target_doc = SSD
â”‚  - Delegates to: Document Agent
â–¼
ğŸ¤– Document Agent (ID: doc-agent-001)
â”‚  - Performs RAG over SSD vector database
â”‚  - Auth via: client_id = doc-agent-001, secret managed by Vault/MCP
â”‚  - Filters by: client = XYZ, doc_type = SSD
â”‚  - Returns:
â”‚     â€¢ doc_status = READY / MISSING
â”‚     â€¢ insights: regulatory alignment, gaps
â”‚  - Writes signed output + doc_insights to memory
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               â–¼
â”‚       ğŸ“§ Email Agent (email-001) [if MISSING]
â”‚       - Drafts request to Sales for SSD
â”‚       - Logs who triggered request
â”‚       - Auth via client_id = email-001 via secure API gateway
â”‚
â–¼
âœ… Human-in-the-Loop Review
â”‚  - Underwriter reviews SSD summary & gaps
â”‚  - Confirms readiness to proceed
â–¼
ğŸ§  Orchestrator (LangGraph FSM)
â”‚  - Reads: doc_scope = SSD, doc_status, user_approval
â”‚  - Stores session approval & insights
â”‚  - Emits signal: READY_FOR_RRF
â–¼
ğŸ”„ RRF Assistance (Planner, ID: rrf-planner-01)
â”‚  - Verifies preconditions for repricing
â”‚  - Extracts: SSD validation, client insights
â”‚  - Confirms eligibility or flags blockers
â–¼
ğŸ“ RRF Agent (rrf-agent-007)
â”‚  - Fills RRF form using stored context
â”‚  - Auth via: rrf-agent-007 credentials from Vault
â”‚  - Validates template completion
â”‚  - Submits via API or queues for review
â”‚  - Logs submission metadata
```

---

**Support Infrastructure**

ğŸ” Identity:

* ğŸ‘¤ User ID (Underwriter)
* ğŸ¤– Agent IDs (doc-agent-001, rrf-agent-007, email-001)
* ğŸ” Auth via: client_id + secret from Vault / Secret Manager

ğŸ§  Memory:

* Redis or LangGraph memory for: doc_scope, approvals, insights
* Shared per-session and agent trace

ğŸ“ˆ Observability:

* OpenTelemetry spans for each step
* Logs: intent match, tool call, result status
* Audit trail for all decisions

ğŸ” Control & Retry:

* Email fallback if missing docs
* Retry-safe RRF planner with gating logic

ğŸ“¡ Secure Tool Invocation:

* MCP / API Gateway governs access
* Client credentials injected per agent call
* Agent-level RBAC enforced via policies

âœ… Human Oversight:

* Every phase checkpointed via underwriter decision
* Configurable approval flows before submission
